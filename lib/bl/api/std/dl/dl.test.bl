#import "std/test"
#import "std/debug_allocator"

#import "std/dl"

main :: fn () s32 {
    debug_allocator.init();
    defer debug_allocator.terminate();
    return test_run();    
}

#private
dl_open_test1 :: fn () #test {
    lib, err :: Dl.open_library("foobar");
    test_not_ok(err);
}

dl_open_test2 :: fn () #test {
    lib, err :: Dl.open_library();
    defer Dl.close_library(lib);
    test_ok(err);
    test_not_null(lib);
}

dl_sym_test1 :: fn () #test {
    lib, err1 :: Dl.open_library();
    defer Dl.close_library(lib);
    sym, err2 :: Dl.get_symbol(lib, "foobar");
    test_not_ok(err2);    
}

/*
dl_sym_test2 :: fn () #test {
    lib, err1 :: Dl.open_library();
    defer Dl.close_library(lib);
    sym, err2 :: Dl.get_symbol(lib, "main");
    test_ok(err2);    
}
*/