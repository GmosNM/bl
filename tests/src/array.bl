#load "libc.bl"
#load "array.bl"

TestCaseCount size_t : 1000;
g_arr *Array := null;

main : fn () s32 {
  g_arr = array_new(sizeof(s32));

  loop (i := 0; i < TestCaseCount; i += 1) {
    array_push_back(g_arr, &i);
  }

  if (g_arr->size != TestCaseCount) { abort(); }

  loop (i := 0; i < TestCaseCount; i += 1) {
    tmp := *(cast(*s32) array_at(g_arr, i));
    if (tmp != cast(s32) i) { abort(); }
  }

  array_delete(g_arr);
  return 0;
};