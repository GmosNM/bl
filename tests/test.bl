/* testing playground */

printf fn (string, s32) s32 : extern;
puts fn (string) s32 : extern;

main : fn () s32 {
  pointers();
  ifs();
  loops();
  local_fn();
  structs();
  globals();

  return 0;
};

pointers : fn () {
  data s32;
  ptr *s32 := &data;
  ptr = &data;

  if ptr == null {
    puts("ptr is null\n");
  } else {
    puts("ptr is not null\n");
  }

  *ptr = 666;

  printf("*ptr = %d\n", *ptr); // implement should load in ir
  printf("data = %d\n", data);
};

ifs : fn () {
  a := true;
  if a {
    puts("ok");
    if !a {
      puts("invalid");
    } else {
      puts("ok");
    }
  } else {
    puts("invalid");
  }
};

loops : fn () {
  i := 0;
  loop {
    if i > 9 { break; }
    printf("i = %d, ", i);
    i = i + 1;
    continue;
  }
  puts("done");

  i = 0;
  while i < 10 {
    printf("i = %d, ", i);
    i = i + 1;
    continue;
  }
  puts("done");
};

local_fn : fn () {
  add : fn (a s32, b s32) s32 {
    return a + b; 
  };

  result := add(10, 20);
  printf("result = %d\n", result);
};

structs : fn () {
  /*data_t : struct {
    i s32,
    j s32
  };*/
};


_global1 := 10;
_global2 := 10 + 15;

globals : fn () {
  //printf("_global1 = %d\n", _global1);
  _globals();
};

_globals : fn () {
};