#import "std/table"

main :: fn () s32 {
    using std;

    print("Count, Insert, Lookup\n");

    count := 1000;
    loop i := 0; i < 12; i += 1 {
        test(count);
        count *= 2;
    }
    return 0;
}

test :: fn (count: s32) {
    using std;
    tbl: Table(s32, s32);
    defer tbl_terminate(&tbl);

    loop i := 0; i < count; i += 1 {
        tbl_insert(&tbl, i, i);
    }
    loop i := 0; i < count; i += 1 {
        it :: tbl_lookup(&tbl, i);
        if it.value != i { panic("Invalid value % vs %", it.value, i); }
    }
    print("%, %, %\n", count, insert_collision_count, lookup_collision_count);
    insert_collision_count = 0;
    lookup_collision_count = 0;
}
